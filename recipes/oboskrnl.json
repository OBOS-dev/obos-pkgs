{
    "name": "oboskrnl",
    "description": "OBOS kernel and drivers",
    "version": [],
    "depends": [ "cross-gcc", "obos-src" ],
    "patches": [],
    "bootstrap-commands": [
       [
            "${root_directory}/scripts/obos-configure.sh",
            "${target_triplet}", "${repo_directory}/obos/", "NO"
       ]
    ],
    "build-commands": [
        [ "cmake", "--build", "." ]
    ],
    "run-commands": [
        [ "qemu-system-x86_64",
          "-drive", "format=raw,file=obos.iso",
          "-M", "q35",
          "-m", "2G",
          "-enable-kvm", "-cpu", "host",
          "-debugcon", "file:/dev/stdout", "-monitor", "stdio",
          "-smp", "4", "-s",
          "-drive", "if=pflash,format=raw,readonly=on,file=$OVMF",
          "-audio", "driver=sdl,model=hda"
         ]
    ],
    "install-commands": [
        [ "export", "DESTDIR=${destdir}" ],
        [ "install", "${repo_directory}/obos/out/ahci", "$$DESTDIR/" ],
        [ "install", "${repo_directory}/obos/out/bochs_vbe", "$$DESTDIR/" ],
        [ "install", "${repo_directory}/obos/out/e1000", "$$DESTDIR/" ],
        [ "install", "${repo_directory}/obos/out/extfs", "$$DESTDIR/" ],
        [ "install", "${repo_directory}/obos/out/i8042", "$$DESTDIR/" ],
        [ "install", "${repo_directory}/obos/out/libps2", "$$DESTDIR/" ],
        [ "install", "${repo_directory}/obos/out/r8169", "$$DESTDIR/" ],
        [ "install", "${repo_directory}/obos/out/slowfat", "$$DESTDIR/" ],
        [ "install", "${repo_directory}/obos/out/test_driver", "$$DESTDIR/" ],
        [ "install", "${repo_directory}/obos/out/uart", "$$DESTDIR/" ]
    ],
    "inhibit-auto-rebuild": true
}
