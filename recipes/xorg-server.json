{
    "name": "xorg-server",
    "description": "Xorg Server",
    "version": [ 21,1,4 ],
    "url": "https://www.x.org/pub/individual/xserver/xorg-server-21.1.4.tar.xz",
    "depends": [ "mlibc", "libpng", "openssl", "libexpat", "xkbfile", "libXfont2", "libxcvt", "xkeyboard-config", "pixman", "xkbcomp" ],
    "build-depends": [ "cross-gcc", "xorgproto" ],
    "patches": [
        {
            "modifies": "xorg-server-21.1.4/hw/xfree86/fbdevhw/fbdevhw.h",
            "patch": "patches/xorg-server/fbdevhw.h.patch"
        },
        {
            "modifies": "xorg-server-21.1.4/hw/xfree86/fbdevhw/fbdevhw.c",
            "patch": "patches/xorg-server/fbdevhw.c.patch"
        },
        {
            "patch": "patches/xorg-server/xf86Config.c.patch",
            "modifies": "xorg-server-21.1.4/hw/xfree86/common/xf86Config.c"
        },
        {
            "patch": "patches/xorg-server/xf86Configure.c.patch",
            "modifies": "xorg-server-21.1.4/hw/xfree86/common/xf86Configure.c"
        },
        {
            "patch": "patches/xorg-server/xf86Events.c.patch",
            "modifies": "xorg-server-21.1.4/hw/xfree86/common/xf86Events.c"
        },
        {
            "patch": "patches/xorg-server/xf86Helper.c.patch",
            "modifies": "xorg-server-21.1.4/hw/xfree86/common/xf86Helper.c"
        },
        {
            "patch": "patches/xorg-server/xf86Init.c.patch",
            "modifies": "xorg-server-21.1.4/hw/xfree86/common/xf86Init.c"
        },
        {
            "patch": "patches/xorg-server/xf86Bus.c.patch",
            "modifies": "xorg-server-21.1.4/hw/xfree86/common/xf86Bus.c"
        },
        {
            "patch": "patches/xorg-server/access.c.patch",
            "modifies": "xorg-server-21.1.4/os/access.c"
        },
        {
            "patch": "patches/xorg-server/xf86_OSlib.h.patch",
            "modifies": "xorg-server-21.1.4/hw/xfree86/os-support/xf86_OSlib.h"
        }
    ],
    "bootstrap-commands": [
        [ "cd", "${repo_directory}/${name}-${version}" ],
        [ "autoreconf", "-fi" ],
        [ "cd", "${bootstrap_directory}/${name}" ],
        [ "${root_directory}/scripts/configure-xorg.sh", "${prefix}", "${repo_directory}", "${target_triplet}", "${name}", "${version}", "${destdir}" ]
    ],
    "build-commands": [
        [ "make", "-j${nproc}" ]
    ],
    "install-commands": [
        [ "make", "install", "DESTDIR=${destdir}" ],
        [ "make", "install", "DESTDIR=${bin_package_prefix}" ]
    ]
}
