--- /dev/null
+++ b/src/obos_mouse.c
@@ -0,0 +1,121 @@
+#ifdef HAVE_XORG_CONFIG_H
+#include <xorg-config.h>
+#endif
+
+#include <xorg-server.h>
+#include <X11/X.h>
+#include <X11/Xproto.h>
+#include "inputstr.h"
+#include "scrnintstr.h"
+#include "mipointer.h"
+
+#include "xf86.h"
+#include "xf86Xinput.h"
+#include "mouse.h"
+#include "xf86_OSlib.h"
+#include "xisb.h"
+
+#include <stdio.h>
+#include <errno.h>
+#include <stdbool.h>
+
+#include <sys/stat.h>
+
+#define MOUSE_FLAG_RB 1
+#define MOUSE_FLAG_MB 2
+#define MOUSE_FLAG_LB 4
+#define MOUSE_FLAG_B4 8
+#define MOUSE_FLAG_B5 16
+
+#include <obos/mouse.h>
+
+static void obosReadInput(InputInfoPtr pInfo) {
+	MouseDevPtr mouse = pInfo->private;
+	mouse_packet packet = {};
+	intptr_t nReady = 0;
+
+
+	ioctl(pInfo->fd, 1 /* query ready count */, &nReady);
+
+	while(nReady-- > 0)
+	{
+		read(pInfo->fd, &packet, sizeof(packet));
+		int b = mouse->lastButtons;
+		b &= ~0x7;
+		b |= (packet.rb) ? 1 : 0;
+		b |= (packet.mb) ? 2 : 0;
+		b |= (packet.lb) ? 4 : 0;
+
+		mouse->PostEvent(pInfo, b, packet.x, -packet.y, packet.z, 0);
+	}
+}
+
+static Bool obosPreInit(InputInfoPtr pInfo, const char* proto, int flag) {
+	MouseDevPtr mouse;
+	
+	mouse = pInfo->private;
+
+	mouse->protocol = proto;
+	
+	xf86ProcessCommonOptions(pInfo, pInfo->options);
+
+	pInfo->fd = xf86OpenSerial(pInfo->options);
+	if(pInfo->fd == -1){
+		xf86Msg(X_ERROR, "%s: cannot open mouse device!\n", pInfo->name);
+		return FALSE;
+	}
+	
+	mouse->CommonOptions(pInfo);
+	pInfo->read_input = obosReadInput;	
+	return true;
+}
+
+#define DEVPATH "/dev/ps2m2"
+
+static const char* getdevice(InputInfoPtr pInfo, const char* proto, int flag){
+	struct stat st;
+
+	if(stat(DEVPATH, &st) == -1)
+		return NULL;
+
+	pInfo->options = xf86AddNewOption(pInfo->options, "Device", DEVPATH);
+	
+	return DEVPATH;
+}
+
+static int interfacesupport() {
+	return MSE_PS2;
+}
+
+static const char* names[] = {
+	"OBOSMouseDev", NULL
+};
+
+static const char** protonames() {
+	return names;
+}
+
+static const char* defaultproto() {
+	return "OBOSMouseDev";
+}
+
+static Bool isdefault(const char *protocol) {
+	return strcmp(protocol, defaultproto()) == 0;
+}
+
+OSMouseInfoPtr OSMouseInit(int flag) {
+	OSMouseInfoPtr p;
+
+	p = calloc(sizeof(OSMouseInfoRec), 1);
+
+	if (!p)
+		return NULL;
+
+	p->SupportedInterfaces = interfacesupport;
+	p->BuiltinNames = protonames;
+	p->FindDevice = getdevice;
+	p->DefaultProtocol = defaultproto;
+	p->CheckProtocol = isdefault;
+	p->PreInit = obosPreInit;
+	return p;
+}
